{{define "post"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faux Rhum - {{index .main_post 1}}</title>
    <link rel="stylesheet" href="./assets/css/post.css" />
</head>
<body>
    {{template "header" .}}

    <!-- Post principal -->
    <div class="page">
        <div class="title-post">{{index .main_post 1}}</div>
        <div class="body-post">
          <div class="message">
            <p>{{index .main_post 2}}</p>
            {{$user := index .main_post 3}}
            {{if eq .user $user}}
            <form action="/delPost" method="POST">
              <input type="hidden" name="delPost" value="{{index .main_post 0}}">
              <button class="del-post">X</button>
            </form>
            {{end}}
          </div>
        </div>
        <div class="author-post">
          <p class="author">
            <span>post created by : </span
              ><a id="user" href="/user?user={{index .main_post 3}}">{{index .main_post 3}}</a>
              <img src="{{index .main_post 5}}">
            </p>
            <span>{{index .main_post 4}}</span>
            <div class="like-container">
              <div class="like">
                {{if and .cookieExist .already_liked}}
                <form action="/post?id={{index .main_post 0}}" method="POST">
                  <input type="hidden" name="Like" value="1">
                  <button style="cursor: pointer;">+1</button>
                </form>
                {{else if .cookieExist}}
                <form action="/post?id={{index .main_post 0}}" method="POST">
                  <input type="hidden" name="Like" value="0">
                  <button style="cursor: pointer;">-1</button>
                </form>
                {{end}}
                <span class="nb-like">{{index .main_post 6}}</span> Likes</div>
            </div>
          </div>
          
          <!-- Ajouter un commentaire -->
          {{if .cookieExist}}
          <div>
            <form action="/post?id={{index .main_post 0}}" method="POST" >
                <input type="text" name="add_comment">
                <button type="submit">Submit</button>
            </form>
        </div>
        {{else}}
        <div class="log">
          <p>Veuillez <a href="/logIn">vous connecter</a> pour poster un commentaire</p>
        </div>
        {{end}}

        <!-- Commentaire -->
        {{range .comments}}
        <div class="full-comment">
          <div class="comment-container">
            <div class="comment">
              {{index . 0}}
            </div>
          </div>
          <div class="author-comment">
            <div class="author-time">
              <p class="author">
                <span>post created by : </span
                ><a id="user" href="/user?user={{index . 1}}">{{index . 1}}</a>
                <img src="{{index . 4}}">
              </p>
              <span>{{index . 2}}</span>
            </div>
          </div>
          </div>
          {{end}}
        </div>
    </div>
    {{template "footer"}}
</body>
</html>
{{end}}